CREATE TABLE "regions" (
	"name"       VARCHAR(32)  NOT NULL,
	"timezone"   VARCHAR(32)  NOT NULL,

	CONSTRAINT "PK_regions" PRIMARY KEY ("name")
);

ALTER TABLE "cities"
RENAME COLUMN "timezone" TO "own_timezone";

ALTER TABLE "cities"
ALTER COLUMN "own_timezone" DROP NOT NULL,
ALTER COLUMN "own_timezone" SET DEFAULT NULL,
ADD COLUMN "region" VARCHAR(32) NOT NULL,
ADD CONSTRAINT "FK_cities_regions" FOREIGN KEY ("region")
	REFERENCES "regions"("name")
	ON DELETE NO ACTION;

INSERT INTO "regions" ("name", "timezone") VALUES
	('Адыгея', 'Europe/Moscow')
	, ('Алтай (Республика Алтай)', 'Asia/Krasnoyarsk')
	, ('Башкортостан', 'Asia/Yekaterinburg')
	, ('Бурятия', 'Asia/Irkutsk')
	, ('Дагестан', 'Europe/Moscow')
	, ('Ингушетия', 'Europe/Moscow')
	, ('Кабардино-Балкария', 'Europe/Moscow')
	, ('Калмыкия', 'Europe/Moscow')
	, ('Карачаево-Черкесия', 'Europe/Moscow')
	, ('Карелия', 'Europe/Moscow')
	, ('Коми', 'Europe/Moscow')
	, ('Крым', 'Europe/Moscow')
	, ('Марий Эл', 'Europe/Moscow')
	, ('Мордовия', 'Europe/Moscow')
	, ('Саха (Якутия)', 'Asia/Yakutsk')
	, ('Северная Осетия', 'Europe/Moscow')
	, ('Татарстан', 'Europe/Moscow')
	, ('Тыва', 'Asia/Krasnoyarsk')
	, ('Удмуртия', 'Europe/Samara')
	, ('Хакасия', 'Asia/Krasnoyarsk')
	, ('Чечня', 'Europe/Moscow')
	, ('Чувашия', 'Europe/Moscow')
	, ('Алтайский край', 'Asia/Krasnoyarsk')
	, ('Забайкальский край', 'Asia/Yakutsk')
	, ('Камчатский край', 'Asia/Kamchatka')
	, ('Краснодарский край', 'Europe/Moscow')
	, ('Красноярский край', 'Asia/Krasnoyarsk')
	, ('Пермский край', 'Asia/Yekaterinburg')
	, ('Приморский край', 'Asia/Vladivostok')
	, ('Ставропольский край', 'Europe/Moscow')
	, ('Хабаровский край', 'Asia/Vladivostok')
	, ('Амурская область', 'Asia/Yakutsk')
	, ('Архангельская область', 'Europe/Moscow')
	, ('Астраханская область', 'Europe/Moscow')
	, ('Белгородская область', 'Europe/Moscow')
	, ('Брянская область', 'Europe/Moscow')
	, ('Владимирская область', 'Europe/Moscow')
	, ('Волгоградская область', 'Europe/Moscow')
	, ('Вологодская область', 'Europe/Moscow')
	, ('Воронежская область', 'Europe/Moscow')
	, ('Ивановская область', 'Europe/Moscow')
	, ('Иркутская область', 'Asia/Irkutsk')
	, ('Калининградская область', 'Europe/Kaliningrad')
	, ('Калужская область', 'Europe/Moscow')
	, ('Кемеровская область', 'Asia/Krasnoyarsk')
	, ('Кировская область', 'Europe/Moscow')
	, ('Костромская область', 'Europe/Moscow')
	, ('Курганская область', 'Asia/Yekaterinburg')
	, ('Курская область', 'Europe/Moscow')
	, ('Ленинградская область', 'Europe/Moscow')
	, ('Липецкая область', 'Europe/Moscow')
	, ('Магаданская область', 'Asia/Magadan')
	, ('Московская область', 'Europe/Moscow')
	, ('Мурманская область', 'Europe/Moscow')
	, ('Нижегородская область', 'Europe/Moscow')
	, ('Новгородская область', 'Europe/Moscow')
	, ('Новосибирская область', 'Asia/Krasnoyarsk')
	, ('Омская область', 'Asia/Omsk')
	, ('Оренбургская область', 'Asia/Yekaterinburg')
	, ('Орловская область', 'Europe/Moscow')
	, ('Пензенская область', 'Europe/Moscow')
	, ('Псковская область', 'Europe/Moscow')
	, ('Ростовская область', 'Europe/Moscow')
	, ('Рязанская область', 'Europe/Moscow')
	, ('Самарская область', 'Europe/Samara')
	, ('Саратовская область', 'Europe/Samara')
	, ('Сахалинская область', 'Asia/Magadan')
	, ('Свердловская область', 'Asia/Yekaterinburg')
	, ('Смоленская область', 'Europe/Moscow')
	, ('Тамбовская область', 'Europe/Moscow')
	, ('Тверская область', 'Europe/Moscow')
	, ('Томская область', 'Europe/Samara')
	, ('Тульская область', 'Europe/Moscow')
	, ('Тюменская область', 'Asia/Yekaterinburg')
	, ('Ульяновская область', 'Europe/Samara')
	, ('Челябинская область', 'Asia/Yekaterinburg')
	, ('Ярославская область', 'Europe/Moscow')

	, ('Еврейская АО', 'Asia/Vladivostok')

	, ('Ненецкий АО', 'Europe/Moscow')
	, ('Ханты-Мансийский АО', 'Asia/Yekaterinburg')
	, ('Чукотский АО', 'Asia/Kamchatka')
	, ('Ямало-Ненецкий АО', 'Asia/Yekaterinburg')
;

INSERT INTO "cities" ("name", "region") VALUES
	('Москва', 'Московская область')
	, ('Санкт-Петербург', 'Ленинградская область')
	, ('Тула', 'Тульская область')
	, ('Одоев', 'Тульская область')
	, ('Иваново', 'Ивановская область')
	, ('Лух', 'Ивановская область')
	, ('Майкоп', 'Адыгея')
	, ('Горно-Алтайск', 'Алтай (Республика Алтай)')
	, ('Уфа', 'Башкортостан')
	, ('Улан-Удэ', 'Бурятия')
	, ('Махачкала', 'Дагестан')
	, ('Магас', 'Ингушетия')
	, ('Нальчик', 'Кабардино-Балкария')
	, ('Элиста', 'Калмыкия')
	, ('Черкесск', 'Карачаево-Черкесия')
	, ('Петрозаводск', 'Карелия')
	, ('Сыктывкар', 'Коми')
	, ('Симферополь', 'Крым')
	, ('Йошкар-Ола', 'Марий Эл')
	, ('Саранск', 'Мордовия')
	, ('Якутск', 'Саха (Якутия)')
	, ('Владикавказ', 'Северная Осетия')
	, ('Казань', 'Татарстан')
	, ('Кызыл', 'Тыва')
	, ('Ижевск', 'Удмуртия')
	, ('Абакан', 'Хакасия')
	, ('Грозный', 'Чечня')
	, ('Чебоксары', 'Чувашия')
	, ('Барнаул', 'Алтайский край')
	, ('Чита', 'Забайкальский край')
	, ('Петропавловск-Камчатский', 'Камчатский край')
	, ('Краснодар', 'Краснодарский край')
	, ('Красноярск', 'Красноярский край')
	, ('Пермь', 'Пермский край')
	, ('Владивосток', 'Приморский край')
	, ('Ставрополь', 'Ставропольский край')
	, ('Хабаровск', 'Хабаровский край')
	, ('Благовещенск', 'Амурская область')
	, ('Архангельск', 'Архангельская область')
	, ('Астрахань', 'Астраханская область')
	, ('Белгород', 'Белгородская область')
	, ('Брянск', 'Брянская область')
	, ('Владимир', 'Владимирская область')
	, ('Волгоград', 'Волгоградская область')
	, ('Вологда', 'Вологодская область')
	, ('Воронеж', 'Воронежская область')
	, ('Иркутск', 'Иркутская область')
	, ('Калининград', 'Калининградская область')
	, ('Калуга', 'Калужская область')
	, ('Кемерово', 'Кемеровская область')
	, ('Киров', 'Кировская область')
	, ('Кострома', 'Костромская область')
	, ('Курган', 'Курганская область')
	, ('Курск', 'Курская область')
	, ('Липецк', 'Липецкая область')
	, ('Магадан', 'Магаданская область')
	, ('Мурманск', 'Мурманская область')
	, ('Нижний Новгород', 'Нижегородская область')
	, ('Великий Новгород', 'Новгородская область')
	, ('Новосибирск', 'Новосибирская область')
	, ('Омск', 'Омская область')
	, ('Оренбург', 'Оренбургская область')
	, ('Орёл', 'Орловская область')
	, ('Пенза', 'Пензенская область')
	, ('Псков', 'Псковская область')
	, ('Ростов-на-Дону', 'Ростовская область')
	, ('Рязань', 'Рязанская область')
	, ('Самара', 'Самарская область')
	, ('Саратов', 'Саратовская область')
	, ('Южно-Сахалинск', 'Сахалинская область')
	, ('Екатеринбург', 'Свердловская область')
	, ('Нижний Тагил', 'Свердловская область')
	, ('Смоленск', 'Смоленская область')
	, ('Тамбов', 'Тамбовская область')
	, ('Тверь', 'Тверская область')
	, ('Томск', 'Томская область')
	, ('Тюмень', 'Тюменская область')
	, ('Ульяновск', 'Ульяновская область')
	, ('Челябинск', 'Челябинская область')
	, ('Ярославль', 'Ярославская область')
	, ('Биробиджан', 'Еврейская АО')
	, ('Нарьян-Мар', 'Ненецкий АО')
	, ('Ханты-Мансийск', 'Ханты-Мансийский АО')
	, ('Анадырь', 'Чукотский АО')
	, ('Салехард', 'Ямало-Ненецкий АО')
	, ('Лабытнанги', 'Ямало-Ненецкий АО')
;

INSERT INTO "cities" ("name", "region", "own_timezone") VALUES
	('Батагай', 'Саха (Якутия)', 'Asia/Vladivostok')
	, ('Среднеколымск', 'Саха (Якутия)', 'Asia/Magadan')
;
